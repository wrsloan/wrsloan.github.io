"0","# Import crude oil prices"
"0","# WTI"
"0","wti <- read.csv('wti_prices.csv', header = TRUE)"
"0","wti <- wti %>%"
"0","  rename('date' = DATE, 'wti_price' = DCOILWTICO) %>%"
"0","  filter(wti_price != '.') %>%"
"0","  mutate(date = as.Date(date, format = '%Y-%m-%d'), week = floor_date(date, 'week'),"
"0","         wti_price = as.numeric(as.character(wti_price)))"
"0","# Mean prices by week"
"0","wti <- aggregate(wti_price ~ week, FUN = mean, data = wti)"
"0","wti <- wti %>%"
"0","  rename('final_date' = 'week') %>%"
"0","  # Change date from beg to end of week"
"0","  mutate(final_date = as.Date(final_date, format = '%Y-%m-%d'), final_date = final_date + 6)"
"0",""
"0","# Brent"
"0","brent <- read.csv('brent_prices.csv', header = TRUE)"
"0","brent <- brent %>%"
"0","  rename('date' = DATE, 'brent_price' = DCOILBRENTEU) %>%"
"0","  filter(brent_price != '.') %>%"
"0","  mutate(date = as.Date(date, format = '%Y-%m-%d'), week = floor_date(date, 'week'),"
"0","         brent_price = as.numeric(as.character(brent_price)))"
"0","# Mean prices by week"
"0","brent <- aggregate(brent_price ~ week, FUN = mean, data = brent)"
"0","brent <- brent %>%"
"0","  rename('final_date' = 'week') %>%"
"0","  # Change date from beg to end of week"
"0","  mutate(final_date = as.Date(final_date, format = '%Y-%m-%d'), final_date = final_date + 6)"
"0",""
"0","# Import sugar prices"
"0","sugar <- read.csv('sugar_prices.csv', header = TRUE)"
"0","sugar <- sugar %>%"
"0","  rename('daily_price' = 'value') %>%"
"0","  filter(as.Date(date) >= '2004-05-10' & as.Date(date) <= '2019-06-01') %>%"
"0","  mutate(date = as.Date(date, format = '%Y-%m-%d'), week = floor_date(date, 'week'))"
"0","# Mean prices by week"
"0","sugar <-  aggregate(daily_price ~ week, FUN = mean, data = sugar)"
"0","sugar <- sugar %>%"
"0","  rename('final_date' = 'week', 'sugar_price' = 'daily_price') %>%"
"0","  # Change date from beg to end of week"
"0","  mutate(final_date = as.Date(final_date, format = '%Y-%m-%d'), final_date = final_date + 6)"
"0",""
"0","# Import Petrobras stock prices"
"0","petrobras <- read.csv('PBR.csv', header = TRUE)"
"0","petrobras <- petrobras %>%"
"0","  select(Date, Open) %>%"
"0","  rename('date' = Date, 'stock_price' = Open) %>%"
"0","  filter(as.Date(date) >= '2004-05-10' & as.Date(date) <= '2019-06-01') %>%"
"0","  mutate(date = as.Date(date, format = '%Y-%m-%d'), week = floor_date(date, 'week'),"
"0","         stock_price = as.numeric(as.character(stock_price)))"
"0","# Mean prices by week"
"0","petrobras <- aggregate(stock_price ~ week, FUN = mean, data = petrobras)"
"0","petrobras <- petrobras %>%"
"0","  rename('final_date' = 'week') %>%"
"0","  # Change date from beg to end of week"
"0","  mutate(final_date = as.Date(final_date, format = '%Y-%m-%d'), final_date = final_date + 6)"
"0",""
"0","# Import Brazil GDP"
"0","b_gdp <- read.csv('brazil_gdp.csv', header = TRUE)"
"0","b_gdp <- b_gdp %>%"
"0","  rename('date' = DATE, 'b_gdp' = BRALORSGPNOSTSAM) %>%"
"0","  mutate(date = as.Date(date, format = '%Y-%m-%d')) %>%"
"0","  filter(date >= '2004-05-01' & date <= '2019-05-01')"
"0",""
"0","# Import China GDP"
"0","c_gdp <- read.csv('china_gdp.csv', header = TRUE)"
"0","c_gdp <- c_gdp %>%"
"0","  rename('date' = DATE, 'c_gdp' = CHNLORSGPNOSTSAM) %>%"
"0","  mutate(date = as.Date(date, format = '%Y-%m-%d')) %>%"
"0","  filter(date >= '2004-05-01' & date <= '2019-05-01')"
"0",""
"0","# Merge dataframes by dates for stock/oil prices, by month for gdp"
"0","df$ym_date <- make_date(year = df$year, month = df$month)"
"0","df$final_date <- as.Date(df$final_date, format = '%Y-%m-%d')"
"0",""
"0","df <- df %>%"
"0","  left_join(b_gdp, by = c('ym_date' = 'date')) %>%"
"0","  left_join(c_gdp, by = c('ym_date' = 'date')) %>%"
"0","  left_join(petrobras, by = 'final_date') %>%"
"0","  left_join(wti, by = 'final_date') %>%"
"0","  left_join(brent, by = 'final_date') %>%"
"0","  left_join(sugar, by = 'final_date')"
